!function(){"use strict";var e,t={2943:function(e,t,i){var n;i.d(t,{c:function(){return n}}),function(e){e.Section="SECTION",e.Widget="WIDGET"}(n||(n={}))},5890:function(e,t,i){var n=i(2008),o=i(680),r=i(9069),a=i(2977);(0,n.N)((({popup:e})=>({filterPhrase:e.filterPhrase,showFilter:e.popupType===r.GI.AddWidget})),(()=>({applyFilter:o.R6})))(a.A)},5860:function(e,t,i){var n=i(2008),o=i(5895),r=i(4611),a=i(9069),s=i(2904);(0,n.N)((e=>{var t;const i=(({editableAreasConfiguration:e,metadata:t,popup:i,widgetZonesConfiguration:n})=>{const r=e[i.areaIdentifier],a=n[i.zoneIdentifier];return(0,o.D)(i.popupType,t,r,a)})(e),{popup:n}=e,s=n.popupType===a.GI.AddWidget&&null!==(t=n.recentWidgets)&&void 0!==t?t:[];return{recentItems:s,columnType:n.columnType,showComponent:n.popupType===a.GI.AddWidget&&i.length>r.oe&&s.length>0}}))(s.A)},9908:function(e,t,i){var n=i(2008),o=i(9813),r=i(680),a=i(9069),s=i(5007);t.A=(0,n.N)((({popup:e},{sectionIdentifier:t})=>({isSectionListOpen:e.componentIdentifier===t&&e.popupType===a.GI.AddSection})),(()=>({closePopup:o.fs,openPopup:(e,t,i)=>(0,r.PB)(e,a.GI.AddSection,t,i),setPopupPosition:o.iy})))(s.A)},4679:function(e,t,i){i.d(t,{Zj:function(){return o},cj:function(){return s},es:function(){return r},g7:function(){return a}});var n=i(1496);const o=(e,t)=>{const i=Object.values(t);return null===e?i:e.length?i.filter((t=>d(e,t.typeIdentifier))):[]},r=(e,t)=>null===e||!!e.length&&d(e,t),a=(e,t)=>e&&n.Qc.contains(e,t),s=(e,t)=>null===e||null===t?null!=e?e:t:null==e?void 0:e.filter((e=>d(t,e))),d=(e,t)=>e.some((e=>n.yO.equalsIgnoreCase(e,t)))},2325:function(e,t,i){i.d(t,{_B:function(){return a},bN:function(){return r}});const n=Object.prototype.hasOwnProperty,o=(e,t)=>e===t?0!==e||0!==t||1/e==1/t:e!=e&&t!=t,r=(e,t)=>{if(o(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;const i=Object.keys(e),r=Object.keys(t);if(i.length!==r.length)return!1;for(let r=0;r<i.length;r++)if(!n.call(t,i[r])||!o(e[i[r]],t[i[r]]))return!1;return!0},a=e=>Array.isArray(e)?e.reduce(((e,t)=>Object.assign(Object.assign({},e),{[t]:{type:null}})),{}):e},1496:function(e,t,i){i.d(t,{DL:function(){return u},Qc:function(){return d},Tg:function(){return l},UI:function(){return a},cT:function(){return p},jp:function(){return c},yO:function(){return s}});var n=i(8999),o=i(9069),r=i(3687);const a={isEmpty(e){return e.constructor===Object&&0===Object.keys(e).length},assignDefined(e,...t){for(const i of t)for(const t of Object.keys(i)){const n=i[t];void 0!==n&&(e[t]=n)}return e}},s={format(e,...t){let i=e;return t.forEach(((e,t)=>{i=i.replace(new RegExp("\\{"+t+"\\}","g"),e)})),i},equalsIgnoreCase(e,t){return 0===e.localeCompare(t,void 0,{sensitivity:"base"})}},d={insertItemIntoArray(e,t,i){return i>e.length||i<0?e:[...e.slice(0,i),t,...e.slice(i)]},replaceItem:(e,t,i)=>!e.length||i>e.length||i<0?e:[...e.slice(0,i),t,...e.slice(i+1)],removeItem:(e,t)=>t>e.length||t<0?e:[...e.slice(0,t),...e.slice(t+1)],moveItemBetweenArrays:(e,t,i,n=null)=>{const o=null===n?e.length-1:n.length;if(i<0||i>o)throw new RangeError("The [position] argument is invalid.");if(!d.contains(e,t))throw new Error("The [item] was not found in [sourceArray].");const r=e.filter((e=>e!==t));return null===n?{sourceArray:d.insertItemIntoArray(r,t,i),destinationArray:null}:{sourceArray:r,destinationArray:d.insertItemIntoArray(n,t,i)}},getUniqueValues:(e,t=(e=>e))=>[...new Set(e.map(t))],contains:(e,t)=>e.indexOf(t)>=0,move:(e,t,i)=>(e.splice(i,0,e.splice(t,1)[0]),e),swap:(e,t,i)=>{const[n,o]=t>i?[i,t]:[t,i];return[...e.slice(0,n),e[o],...e.slice(n+1,o),e[n],...e.slice(o+1)]},toRecord:(e,t)=>e.reduce(((e,i)=>(e[i[t]]=i,e)),{})},l={dispatchEvent:(e,t)=>{const i=new CustomEvent(e,{detail:t});document.dispatchEvent(i)},getEventPath:e=>{let t=[],i=e.target;if(e.path)t=e.path;else for(;i;)t.push(i),i=i.parentElement;return t.filter((e=>e instanceof Node))}},c={removeSectionFromDragAndDrop:e=>{l.dispatchEvent(n.Kr,{sectionIdentifier:e})},mountSectionToDragAndDropAfterNextTick:async(e,t)=>{await e.$nextTick((()=>{c.mountSectionToDragAndDrop(t)}))},mountSectionToDragAndDrop:e=>{l.dispatchEvent(n.Oq,{sectionIdentifier:e})}},u={disableDocumentLinks:()=>{const e=document.getElementsByTagName("a"),t=e.length;for(let i=0;i<t;i++)e[i].onclick=()=>!1},disableElementLinks:e=>{const t=e.getElementsByTagName("a"),i=t.length;let n;for(let e=0;e<i;e++)n=t[e],n.closest("div[data-inline-editor]")||(n.onclick=()=>!1)}},p={getTheme:e=>{switch(e){case o.GI.AddWidget:case o.GI.Personalization:return r.Sx.Widget;case o.GI.AddSection:case o.GI.ChangeSection:return r.Sx.Section}},isFriendlyElementSelected:(e,t)=>l.getEventPath(e).some((e=>t.some((t=>{const i=document.querySelector(t);return i&&(i===e||i.contains(e))})))),doesElementOrAncestor(e,t,i){let n=e;for(;n;){if(i(n))return!0;if(t&&t===n)break;n=n.parentElement}return!1}}},5895:function(e,t,i){i.d(t,{D:function(){return s},d:function(){return d}});var n=i(6485),o=i(4679),r=i(9069),a=i(3687);const s=(e,t,i,s)=>{var d;if(![r.GI.AddWidget,r.GI.AddSection].includes(e))return[];const l=(0,n.cQ)(a.SL.PopUpElementsService),c=e===r.GI.AddWidget,u=c?t.widgets:t.sections,p=c?(0,o.cj)(i.widgetRestrictions,null!==(d=null==s?void 0:s.widgetRestrictions)&&void 0!==d?d:null):i.sectionRestrictions,f=(0,o.Zj)(p,u);return c?l.getWidgetElements(f):l.getSectionElements(f)},d=(e,t)=>{if(!t)return e;const i=t.toLowerCase();return e.filter((e=>e.name.toLowerCase().includes(i)))}},1945:function(e,t,i){i.d(t,{ME:function(){return a},cx:function(){return r},m9:function(){return c},tK:function(){return o}});var n=i(9069);const o={Pixel:"pixel",Percent:"percent"},r=(e,t,i=o.Pixel)=>{const r=d(e),a=s(t,i)/2;return r.left<a?n.lD.Right:r.right<a?n.lD.Left:n.lD.Center},a=e=>e.top>window.innerHeight/2?n.nl.Top:n.nl.Bottom,s=(e,t)=>t===o.Percent?e:l(null!=e?e:(e=>{const t=document.body.querySelector("kentico-pop-up-container");return t&&t.offsetWidth?t.offsetWidth:e})(e)),d=e=>({left:l(e.left),right:l(window.innerWidth-e.right)}),l=e=>e/window.innerWidth,c=e=>({left:e.left+e.width/2+pageXOffset,top:a(e)===n.nl.Top?e.top-10+pageYOffset:e.top+e.height+10+pageYOffset})},4611:function(e,t,i){i.d(t,{Hd:function(){return r},oe:function(){return o},$v:function(){return a}});const n="ktc.pagebuilder.recentwidgets",o=4,r=4,a=()=>{var e;return null!==(e=(e=>{const t=localStorage.getItem(e);return t?JSON.parse(t):void 0})(n))&&void 0!==e?e:[]}},3e3:function(e,t,i){i.d(t,{r:function(){return c}});var n=i(373),o=i.n(n),r=i(3821),a=i(3972),s=i(4339),d=i(7215);let l=!1;const c=(e,t,i,n,l,c)=>(0,r.v)((()=>{if(!e)return;n&&(0,d.I)(),p(e);const r=n?u(e):{},f=(0,a.k)(i,t,r),g=(0,s.u)(f,t,r,l);c&&c(g),new(o())(e,g)})),u=e=>{const t=e.dataset.richTextEditorConfiguration,{richTextEditor:i}=window.kentico.pageBuilder,n=i&&i.configurations&&i.configurations[t];return"object"==typeof n?n:{}},p=e=>{if(l)return;const{enableImageRecognition:t,getLinkMetadataEndpointUrl:i,richTextEditorLicense:o,contextMacros:r,getImageDescriptionEndpointUrl:a}=e.dataset,s="true"===t.toLowerCase();Object.assign(n.DEFAULTS,{getLinkMetadataEndpointUrl:i,licenseKey:o,getImageDescriptionEndpointUrl:a,isImageRecognitionEnabled:s},r?{contextMacros:JSON.parse(r)}:{}),l=!0}},4434:function(e,t,i){i.d(t,{K:function(){return a}});var n=i(373),o=i.n(n);i(4077),i(3e3),i(4361);var r=i(7215);const a=()=>{o().MAIL_REGEX=/^\w+([.-]?\w+)*@\w+([.-]?\w+)*(\.\w{2,3})+$/;const e=n.DEFAULTS.videoInsertButtons||[];delete e[e.indexOf("videoUpload")],(0,r.p)()}},4361:function(e,t,i){i.d(t,{AG:function(){return h},Ge:function(){return g},Up:function(){return v},jO:function(){return m}});var n=i(4425),o=i.n(n),r=i(5494),a=i.n(r),s=i(596),d=i(696),l=i(2234);const c=/<input [^>]*data-macro-type="(query|pattern)[^>]*>/g,u=/data-macro-value="([^"]*)"/,p=/data-macro-default-value="([^"]*)"/,f=/{%\s*ResolveDynamicText\(\s*"(query|pattern)"\s*,\s*"([^"]+)"\s*,\s*"(.*?)"\s*\)\s*%}/g,g=e=>e.replace(c,((e,t)=>`{% ResolveDynamicText("${t}", "${e.match(u)[1]||""}", "${a()(e.match(p)[1]).replace(/"/g,'\\"')}") %}`)),m=(e,t)=>e.replace(f,((e,i,n,r)=>(0,l.wk)(i,n,o()(r.replace(/\\"/g,'"')),(0,d.G)(t,n)))),v=e=>e.replace(f,""),h=e=>{e.el.querySelectorAll(`.${s.mm}`).forEach((t=>{t.onclick=()=>e.kenticoMacroPlugin.showActionsPopup(t),t.onmousedown=e=>{2===e.button&&e.stopPropagation()}}))}},4077:function(e,t,i){i.d(t,{ML:function(){return c},Qj:function(){return s},Ul:function(){return d},Vr:function(){return l}});var n=i(6485),o=i(3855),r=i(3687);const a={},s=(e,t)=>{const i=e.querySelectorAll("[data-inline-editor]"),s=(0,n.cQ)(r.SL.LocalizationService),d={cultureCode:s.getCultureCode(),getString:s.getLocalizationWithoutPrefix};for(const e of i){const i=e.dataset.inlineEditor,n=a[i];if(!n){const e=s.getLocalization("inlineeditors.notregistered",i);o.v.logError(e);continue}const r=e.dataset.propertyName;if(r&&r.length)try{n.init({editor:e,propertyName:r,localizationService:d,propertyValue:t[r]})}catch(e){o.v.logException(e)}else{const e=s.getLocalization("inlineeditors.missingpropertyname",i);o.v.logError(e)}}},d=e=>{u(e,"dragStart")},l=e=>{u(e,"drop")},c=e=>{u(e,"destroy")},u=(e,t)=>{const i=e.querySelectorAll("[data-inline-editor]");for(const e of i){const i=e.dataset.inlineEditor,n=a[i];if(n.hasOwnProperty(t)){const i=n[t],o={editor:e};i.call(i,o)}}}},6797:function(e,t,i){i.d(t,{CO:function(){return m},Dh:function(){return u},LG:function(){return f},bQ:function(){return v},wB:function(){return b},wR:function(){return p},zU:function(){return g}});var n=i(903),o=i(7307),r=i(1496),a=i(3687),s=i(8885),d=i(6520),l=i(691);const c=[],u=(e,t=[],i=0)=>(n,o,{localizationService:r})=>{h(e);const{title:a,url:s,data:u,theme:p,width:f,maximized:g,showFooter:m,applyButtonText:v,cancelButtonText:b}=y(e,r);c.push({applyCallback:e.applyCallback,cancelCallback:e.cancelCallback||(()=>null)});n((0,new d.G(w).openModalDialog)({componentIdentifier:`CustomDialog${c.length}`,dialogType:l.W.Custom,dialogTitle:a,dialogMarkupUrl:s,dialogTabs:t,activeTabIndex:i,dialogMarkupModel:u,dialogTheme:p,dialogWidth:f,maximized:g,showFooter:m,applyButtonText:v,cancelButtonText:b}))},p=e=>(t,i)=>{const n=i().modalDialogs.dialogs.length-1;t(s.vp(n,e))},f=(e,t=m)=>async(i,n,{logger:o})=>{try{const o=await c[c.length-1].applyCallback(e);if(o&&!1===o.closeDialog)return;const r=n().modalDialogs.dialogs.length-1;i(t(r)),c.pop()}catch(e){o.logException(e)}},g=(e,t=m)=>async(i,n,{logger:o})=>{try{await c[c.length-1].cancelCallback(e)}catch(e){o.logException(e)}finally{const e=n().modalDialogs.dialogs.length-1;i(t(e)),c.pop()}},m=e=>(t,i,{messaging:n})=>{n.postMessage(a.lA.CLOSE_MODAL_DIALOG,null,"*"),t(s.CO(e))},v=()=>(e,t)=>{const i=t().modalDialogs.dialogs;return i.length<=0||i[i.length-1].type!==l.W.Custom?null:(0,n.A)(i[i.length-1].model)},h=e=>{if(!e.url||!e.applyCallback)throw new TypeError("Passed options do not have required properties.");if("function"!=typeof e.applyCallback)throw new TypeError("applyCallback is not an instance of a Function type.");if(e.cancelCallback&&"function"!=typeof e.cancelCallback)throw new TypeError("cancelCallback is not an instance of a Function type.");if("string"!=typeof e.url)throw new TypeError("url is not of the type string.");if(e.title&&"string"!=typeof e.title)throw new TypeError("title is not of the type string.");if(e.theme&&-1===Object.values(a.Sx).indexOf(e.theme))throw new TypeError("theme does not match any of the existing dialog themes.");if(void 0!==e.width&&("string"!=typeof e.width||!e.width.endsWith("px")&&!e.width.endsWith("%")))throw new TypeError("width must be represented by 'XXXpx' or 'XX%' string values.");if(void 0!==e.maximized&&"boolean"!=typeof e.maximized)throw new TypeError("maximized must be of type boolean.");if(void 0!==e.showFooter&&"boolean"!=typeof e.showFooter)throw new TypeError("showFooter must be of type boolean.")},y=(e,t)=>{const i={showFooter:!0,width:"66%",maximized:!1,applyButtonText:t.getLocalization("modaldialog.buttons.apply"),cancelButtonText:t.getLocalization("modaldialog.buttons.cancel")};return r.UI.assignDefined(i,e)},w=e=>({title:e.dialogTitle,markupUrl:e.dialogMarkupUrl,model:e.dialogMarkupModel,theme:e.dialogTheme}),b=(e,t,i)=>async(n,r,{logger:a})=>{try{const r=await(0,o.q)(t,i);n(s.dO(e,r))}catch(e){a.logException(e)}}},6013:function(e,t,i){i.d(t,{PB:function(){return l},R6:function(){return u}});var n=i(8999),o=i(5895),r=i(1945),a=i(4611),s=i(9813),d=i(9069);const l=(e,t,i,n=null,a=null,l=0)=>(u,p)=>{const f=(0,r.m9)(i);let g,m=d.lD.Center,v=d.nl.Bottom,h=d.Ce.Single,y=0;if([d.GI.AddSection,d.GI.AddWidget].includes(t)){const{metadata:s,editableAreasConfiguration:u,widgetZonesConfiguration:f,zones:w,editableAreas:b}=p(),I=(0,o.D)(t,s,u[n],f[a]);[g,h]=c(I.length+l,t),m=(0,r.cx)(i,g,r.tK.Percent),v=(0,r.ME)(i),y=t===d.GI.AddWidget?e!==a?w[a].widgets.indexOf(e):0:b[n].sections.indexOf(e)}u((0,s.PB)(e,m,v,t,f,n,a,h,y))},c=(e,t)=>{switch(!0){case e<=5:return[n.zG,d.Ce.Single];case e<=12||t===d.GI.AddSection:return[n.qg,d.Ce.Double];case e>12:return[n.Yp,d.Ce.Quadruple]}},u=e=>(t,i)=>{const{editableAreasConfiguration:n,metadata:r,popup:a,widgetZonesConfiguration:d}=i();let l=p(n,d,r,a.areaIdentifier,a.zoneIdentifier);e&&(l=(0,o.d)(l,e)),t((0,s.Vu)(l)),t((0,s.R6)(e))},p=(e,t,i,n,r)=>{const s=(0,a.$v)();if(!s.length)return[];const l=e[n],c=t[r],u=(0,o.D)(d.GI.AddWidget,i,l,c),p=new Map(u.map((e=>[e.key,e]))),f=s.map((e=>p.get(e))).filter((e=>e));return f.splice(a.Hd),f}},3196:function(e,t,i){i.d(t,{Qk:function(){return g},hz:function(){return f},xj:function(){return l}});var n=i(3856),o=i(3829),r=i(3),a=i(1843),s=i(1977),d=i(6313);const l=async(e,t,i)=>{const n=(0,d.MA)(t.sections[e].zones,t.zones),o=c(n,t);0!==o.length&&await u(o,t,i)},c=(e,t)=>{const i=e=>t.markups.variants[e].isDirty,n=e.reduce(((e,n)=>{const o=t.widgets[n].type,r=t.widgets[n].variants.filter(i);return 0===r.length?e:void 0===e[o]?Object.assign(Object.assign({},e),{[o]:r}):Object.assign(Object.assign({},e),{[o]:[...e[o],...r]})}),{});return Object.entries(n)},u=async(e,t,i)=>{const o=p(e,t),r=await Promise.all(o),a=(0,n.A)(e,(([e,t])=>t)).reduce(((e,t,i)=>(e[t]=r[i],e)),{});i((0,s.W)(a))},p=(e,t)=>(0,n.A)(e,(([e,i])=>{const n=t.metadata.widgets[e].markupUrl;return i.map((e=>{const i=t.widgetVariants[e].properties;return r.U6(n,i)}))})),f=async(e,t,i=null,n=null)=>{const s=e.metadata.sections[t];!0===s.hasProperties&&null===n&&(n=await r.yx(s.defaultPropertiesUrl));const d=await r.U6(s.markupUrl,n),l=(0,a.hR)(d),c={identifier:i||(0,o.A)(),type:t,properties:n,zones:[]},u=(0,a.N3)(l.markup);u.forEach((e=>c.zones.push(e.identifier)));const{markup:p,restrictions:f}=(0,a.OL)(l.markup,c.zones);return{section:c,markup:{markup:p},widgetZones:u,widgetRestrictions:f}},g=(e,t,i,n)=>{const o={source:e.zones.reduce(((e,t)=>(e[t]=n.zones[t].name,e)),{}),target:i.reduce(((e,{identifier:t,name:i})=>(e[t]=i,e)),{})};return(0,d.QT)(m(e.zones,o.source),m(t.zones,o.target),n.zones)},m=(e,t)=>e.map((e=>({identifier:e,name:t[e]})))},7723:function(e,t,i){i.d(t,{Bn:function(){return d},Uf:function(){return l},hB:function(){return u},k7:function(){return c},tH:function(){return p}});var n=i(8542),o=i(6313),r=i(1496),a=i(4670),s=i(3196);const d=(e,t,i)=>async(n,o)=>{const{section:r,markup:d,widgetZones:l,widgetRestrictions:c}=await(0,s.hz)(o(),e);n(a.Bn(r,t,i,d,l,c))},l=(e,t)=>async(i,d)=>{const l=d(),c=l.sections[e],u=(0,o.MA)(c.zones,l.zones),p=Object.values((0,n.A)(l.widgets,u));if(1===l.editableAreas[t].sections.length){const{section:n,markup:o,widgetZones:d,widgetRestrictions:u}=await(0,s.hz)(l,l.editableAreasConfiguration[t].defaultSection,e);i(a.k7(c,n,o,r.Qc.toRecord(d,"identifier"),u,p))}else i(a.Uf(c,t,p))},c=(e,t)=>async(i,n)=>{const o=n(),r=o.sections[e],{section:d,markup:l,widgetZones:c,widgetRestrictions:u}=await(0,s.hz)(o,t);await(0,s.xj)(e,o,i);const p=(0,s.Qk)(r,d,c,o);i(a.k7(r,d,l,p,u))},u=(e,t,i,n)=>async(o,r)=>{const d=r();if(await(0,s.xj)(e,d,o),1===d.editableAreas[t].sections.length){const{section:e,markup:i,widgetZones:n,widgetRestrictions:r}=await(0,s.hz)(d,d.editableAreasConfiguration[t].defaultSection);o(a.Bn(e,t,0,i,n,r))}o(a.hB(e,t,i,n))},p=(e,t)=>async(i,n,o)=>{try{const o=n(),r=o.sections[e],{section:d,markup:l,widgetZones:c,widgetRestrictions:u}=await(0,s.hz)(o,r.type,e,t);await(0,s.xj)(e,o,i);const p=(0,s.Qk)(r,d,c,o);i(a.k7(r,d,l,p,u))}catch(e){o.logger.logException(e)}}},680:function(e,t,i){i.d(t,{CO:function(){return r.CO},wB:function(){return r.wB},PB:function(){return n.PB},R6:function(){return n.R6},tH:function(){return a.tH},Uq:function(){return o.Uq}});i(3),i(5723),i(1977);var n=i(6013),o=i(9177),r=i(6797),a=i(7723)},9069:function(e,t,i){i.d(t,{Ce:function(){return a},GI:function(){return r},WV:function(){return s.W},lD:function(){return n},nl:function(){return o}});var n,o,r,a,s=i(691);!function(e){e.Center="center",e.Left="left",e.Right="right"}(n||(n={})),function(e){e.Top="top",e.Bottom="bottom"}(o||(o={})),function(e){e.AddWidget="addWidget",e.AddSection="addSection",e.ChangeSection="changeSection",e.Personalization="personalization"}(r||(r={})),function(e){e.Single="single",e.Double="double",e.Quadruple="quadruple"}(a||(a={}))},8053:function(e,t,i){i.d(t,{CT:function(){return r},Ro:function(){return s},Xj:function(){return o},aC:function(){return l},aK:function(){return a},je:function(){return d}});var n=i(7475);const o=(0,n.createAction)("widgetSelection/SELECT",(e=>({widgetIdentifier:e})))(),r=(0,n.createAction)("widgetSelection/UNSELECT")(),a=(0,n.createAction)("widgetSelection/FREEZE")(),s=(0,n.createAction)("widgetSelection/THAW")(),d=(0,n.createAction)("widgetSelection/DISABLE_CLICK_AWAY")(),l=(0,n.createAction)("widgetSelection/ENABLE_CLICK_AWAY")()},4773:function(e,t,i){i(4772);var n=i(6485),o=(i(4741),i(9492)),r=i(1880),a=i(3687),s=i(104),d=i(2310),l=function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,i,a):o(t,i))||a);return r>3&&a&&Object.defineProperty(t,i,a),a},c=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let u=class extends d.c{constructor(){super("kentico.formbuilder")}};u=l([(0,s._)(),c("design:paramtypes",[])],u);var p=i(1235);const f=new p.wQ.Entity("widgetVariants",{},{idAttribute:"identifier"}),g=new p.wQ.Entity("widgets",{variants:[f]},{idAttribute:"identifier"}),m=new p.wQ.Entity("zones",{widgets:[g]},{idAttribute:"identifier"}),v=new p.wQ.Entity("sections",{zones:[m]},{idAttribute:"identifier"}),h={editableAreas:[new p.wQ.Entity("editableAreas",{sections:[v]},{idAttribute:"identifier"})]};var y=i(829);var w=i(1496),b=function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,i,a):o(t,i))||a);return r>3&&a&&Object.defineProperty(t,i,a),a},I=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(i[n[o]]=e[n[o]])}return i};let C=class{normalizeConfiguration(e){this.renameZoneConfiguration(e,"formComponents","widgets");const t=(0,p.S8)(e,h).entities;this.mergePropertiesFromVariantsToComponents(e,t);return w.UI.isEmpty(t)?{editableAreas:{},sections:{},zones:{},widgets:{},widgetVariants:{}}:t}denormalizeConfiguration(e){const t=(0,p.NU)({editableAreas:Object.keys(e.editableAreas)},h,e);return this.renameZoneConfiguration(t,"widgets","formComponents"),this.mergePropertiesFromComponentsToVariants(e,t),t}normalizeMetadata(e){const t=e.formComponents.map((e=>{const{identifier:t}=e,i=I(e,["identifier"]);return Object.assign(Object.assign({},i),{hasEditableProperties:!1,hasProperties:!0,propertiesFormMarkupUrl:null,typeIdentifier:e.identifier})})),i=(0,p.S8)({sections:e.sections,widgets:t},y.R).entities;return{widgets:i.widgets||{},sections:i.sections||{},pageTemplates:{},personalizationConditionTypes:{}}}renameZoneConfiguration(e,t,i){for(const n of e.editableAreas)for(const e of n.sections)for(const n of e.zones)n[i]=n[t],delete n[t]}mergePropertiesFromComponentsToVariants(e,t){for(const i of t.editableAreas)for(const t of i.sections)for(const i of t.zones)for(const t of i.formComponents)t.properties=e.widgetVariants[t.variants[0].identifier].properties,delete t.variants}mergePropertiesFromVariantsToComponents(e,t){for(const i of e.editableAreas)for(const e of i.sections)for(const i of e.zones)for(const e of i.widgets)t.widgetVariants=t.widgetVariants||{},t.widgetVariants[e.identifier]={identifier:e.identifier,name:e.identifier,properties:e.properties},t.widgets[e.identifier].variants=t.widgets[e.identifier].variants||[],Object.assign(t.widgets[e.identifier].variants,[e.identifier]),delete t.widgets[e.identifier].properties}};C=b([(0,s._)()],C);var R=i(9149);const k="kenticoFormBuilderFreezeUI",E="kenticoFormBuilderUnfreezeUI",S="kenticoPropertiesStateChanged",V="kenticoValidationRuleStateChanged",A="kenticoFormBuilderCloseExpandedValidationRuleConfiguration",P="kenticoVisibilityConditionStateChanged",T="Kentico.UnknownSection";var L=function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,i,a):o(t,i))||a);return r>3&&a&&Object.defineProperty(t,i,a),a};let M=class extends R.X{getSectionElements(e){return e=e.filter((e=>e.typeIdentifier!==T)),this.getWidgetElements(e)}};M=L([(0,s._)()],M);var O=i(3855),x=i(7381),z=i(1843),W=i(9682);const F=(e,t)=>{document.dispatchEvent(new CustomEvent("kenticoRenderMarkup",{detail:{markup:t,targetElementId:e}}))},j=async e=>{try{return await e()}catch(e){throw O.v.logException(e),e}};var D=function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,i,a):o(t,i))||a);return r>3&&a&&Object.defineProperty(t,i,a),a};let N=class extends x.L{async getConfiguration(e){const t=await super.getConfiguration(e),i=(0,n.cQ)(a.SL.LocalizationService),o=Object.values(t.markups.sections).some((e=>!e.markup));o&&O.v.logError(i.getLocalization("error.sectionrender"));const r=Object.values(t.sections).some((e=>e.type===T));r&&(0,z.FF)("error.sectionconfig",[]);const s=await(async()=>{const e=W.q$.validationRuleMetadataEndpoint;return j((async()=>(await W.LV.get(e)).data))})();return Object.assign(Object.assign({},t),{validationRulesMetadata:s})}};N=D([(0,s._)()],N);const B=new o.m({skipBaseClassChecks:!0});B.bind(a.SL.LocalizationService).to(u),B.bind(a.SL.NormalizerService).to(C),B.bind(a.SL.PageConfigurationService).to(N),B.bind(a.SL.PopUpElementsService).to(M),B.bind(a.SL.MessagingService).to(r.U);var q=i(2717),_=i(1425),$=i(3079),G=i(3502),U=i(2008),X=i(1945),Q=i(9813),K=i(9069),H=i(7229),Z=i(6034),Y=i(9908),J=i(7723),ee=i(7475);const te=(0,ee.createAction)("expandedValidationRuleIdentifier/EXPAND_VALIDATION_RULE",(e=>({validationRuleIdentifier:e})))(),ie=(0,ee.createAction)("newValidationRuleIdentifiers/NEW_VALIDATION_RULE_IDENTIFIER",((e,t)=>({identifierForNewValidationRule:e,widgetVariantIdentifier:t})))(),ne=(0,ee.createAction)("newValidationRuleIdentifiers/VALIDATION_RULE_ADDED",((e,t,i)=>({validationRuleIdentifier:e,identifierForNewValidationRule:t,widgetVariantIdentifier:i})))(),oe=(0,ee.createAction)("refreshPropertiesPanelsNotifier/REFRESH")(),re=(0,ee.createAction)("savingInProgress/SHOW_SAVING_MESSAGE")(),ae=(0,ee.createAction)("savingInProgress/SHOW_SAVED_MESSAGE")();var se=i(3),de=i(3531);const le=[],ce=async(e,t,i)=>{e(re()),await(async e=>{let t,i;const n=le[le.length-1],o=new Promise(((e,n)=>{t=e,i=n}));if(le.push(o),n)try{await n}catch(e){}try{const i=await e();return t(),i}catch(e){return i(),Promise.reject(e)}finally{le.splice(0,1)}})((()=>j((async()=>(0,se.LZ)(t,i))))),(0,de.postMessage)(a.lA.CONFIGURATION_CHANGED,null,"*"),e(ae())},ue=(e,t,i)=>async(n,o,r)=>{try{w.Tg.dispatchEvent(k,{}),n(re()),await J.Bn(e,t,i)(n,o,r);const a=W.q$;await ce(n,o(),a.formIdentifier.toString()),w.Tg.dispatchEvent(E,{})}catch(e){r.logger.logException(e)}},pe=(e,t)=>async(i,n,o)=>{try{w.Tg.dispatchEvent(k,{}),i(re()),await J.Uf(e,t)(i,n,o);const r=W.q$;await ce(i,n(),r.formIdentifier.toString()),w.Tg.dispatchEvent(E,{})}catch(e){o.logger.logException(e)}},fe=(e,t)=>async(i,n,o)=>{try{w.Tg.dispatchEvent(k,{}),i(re()),await J.k7(e,t)(i,n,o);const r=W.q$;await ce(i,n(),r.formIdentifier.toString()),w.Tg.dispatchEvent(E,{})}catch(e){o.logger.logException(e)}},ge=(e,t,i,n)=>async(o,r,a)=>{try{w.Tg.dispatchEvent(k,{}),o(re()),await J.hB(e,t,i,n)(o,r,a);const s=W.q$;await ce(o,r(),s.formIdentifier.toString()),w.Tg.dispatchEvent(E,{})}catch(e){a.logger.logException(e)}};var me=i(2981),ve=i(9177);const he=(e,t,i)=>async(n,o,r)=>{try{n((0,me.aK)()),n(re());const a=await ve.QD(e,t,i)(n,o,r),s=W.q$;return await ce(n,o(),s.formIdentifier.toString()),n(oe()),n((0,me.Ro)()),a}catch(e){r.logger.logException(e)}},ye=(e,t,i,n)=>async(o,r,a)=>{try{await ve.Gm(e,t,i,n)(o,r,a);const s=W.q$;await ce(o,r(),s.formIdentifier.toString()),o(oe())}catch(e){a.logger.logException(e)}},we=(e,t)=>async(i,n,o)=>{try{ve.hW(e,t)(i,n,o);const r=W.q$;await ce(i,n(),r.formIdentifier.toString()),i(oe())}catch(e){o.logger.logException(e)}},be=(e,t)=>async(i,n,o)=>{try{await ve.k_(e,t)(i,n,o);const r=W.q$;await ce(i,n(),r.formIdentifier.toString()),i(oe())}catch(e){o.logger.logException(e)}};var Ie=i(7406);var Ce=(0,U.N)(((e,t)=>({sectionsInArea:e.editableAreas[t.identifier].sections,dragAndDrop:e.dragAndDrop})),(()=>({removeSection:pe,changeSection:fe})))(Ie.A),Re=i(6520);const ke=[".buttonTooltip","is-template-button",".icon","button-type"];var Ee=(0,_.pM)({data(){return{changePropertiesIcon:a.a2.Properties,buttonType:a.VQ.Properties}},computed:{localizedButtonTooltip(){return this.$_localizationService.getLocalization(this.buttonTooltip)}},methods:{onOpenPropertiesDialog(){this.openModalDialog({componentIdentifier:this.identifier,dialogType:K.WV.SectionProperties,showFooter:!0})}},props:{identifier:{required:!0,type:String},buttonTooltip:{required:!0,type:String},dialogType:{required:!0,type:String},isTemplateButton:{default:!1,type:Boolean},openModalDialog:{type:Function}}}),Se=i(6262);var Ve=(0,Se.A)(Ee,[["render",function(e,t,i,n,o,r){return(0,_.uX)(),(0,_.CE)("div",null,[(0,_.Lk)("kentico-header-button",{".buttonTooltip":e.localizedButtonTooltip,"is-template-button":e.isTemplateButton,".icon":e.changePropertiesIcon,"button-type":e.buttonType,onClick:t[0]||(t[0]=(...t)=>e.onOpenPropertiesDialog&&e.onOpenPropertiesDialog(...t))},null,40,ke)])}]]);const Ae=(e,t,i)=>{const{componentIdentifier:n}=e,{metadata:o,sections:r}=t;let s;return s={title:o.sections[r[n].type].name,markupUrl:o.sections[r[n].type].propertiesFormMarkupUrl,model:r[n].properties,theme:a.Sx.Section},Object.assign(Object.assign({},s),{title:i.getLocalization("widgetproperties.header",s.title)})};var Pe=(0,U.N)((()=>({})),(()=>({openModalDialog:new Re.G(Ae).openModalDialog})))(Ve);const Te={key:0,class:"ktc-extra-header-buttons"};var Le=(0,_.pM)({__name:"SectionHeaderExtraButtons",props:{sectionIdentifier:{},showPropertiesButton:{type:Boolean}},setup(e){const t=(0,_.KR)(a.VQ.Properties),i=(0,_.KR)(K.WV.SectionProperties);return(e,n)=>e.showPropertiesButton?((0,_.uX)(),(0,_.CE)("div",Te,[(0,_.bF)((0,_.R1)(Pe),{identifier:e.sectionIdentifier,dialogType:i.value,"button-type":t.value,buttonTooltip:"section.propertiesButtonTooltip"},null,8,["identifier","dialogType","button-type"])])):(0,_.Q3)("",!0)}});var Me=(0,U.N)(((e,t)=>{const i=e.sections[t.sectionIdentifier];return{showPropertiesButton:!!i&&e.metadata.sections[i.type].hasProperties}}))(Le),Oe=i(2829);var xe=i(2776),ze=i(2943);const We=[".localizationService",".widgetTitle"];var Fe=(0,_.pM)({props:{widgetTitle:{required:!0,type:String},widgetIdentifier:{required:!0,type:String},activeItemIdentifier:{type:String},showWidgetHeader:{type:Boolean}}});var je=(0,Se.A)(Fe,[["render",function(e,t,i,n,o,r){return(0,_.bo)(((0,_.uX)(),(0,_.CE)("kentico-widget-header",{class:"ktc-widget-header--top",".localizationService":e.$_localizationService,".widgetTitle":e.widgetTitle},null,40,We)),[[_.aG,e.showWidgetHeader]])}],["__scopeId","data-v-a9f2fe56"]]);var De=(0,U.N)(((e,{widgetIdentifier:t})=>{const{widgetVariants:i,displayedWidgetVariants:n,widgetSelection:o,dragAndDrop:r,highlightedWidget:a}=e,s=i[n[t]];return{showWidgetHeader:(a===t||o.identifier===t)&&r.entity!==ze.c.Widget,activeItemIdentifier:s?s.identifier:null}}))(je),Ne=i(6013),Be=i(2010);var qe=(0,U.N)(((e,t)=>{const{dragAndDrop:i,widgets:n,popup:o,zones:r,sections:a}=e,{sectionIdentifier:s,zoneIndex:d}=t,l=a[s]?a[s].zones[d]:"";return{zoneIdentifier:l,dragAndDrop:i,zone:r[l],popup:o,widgetsInZone:r[l]?r[l].widgets.map((e=>n[e])):[]}}),(()=>({removeWidget:we,closePopup:me.fs,openPopup:(e,t,i=null,n=null,o=0)=>(0,Ne.PB)(e,K.GI.AddWidget,t,i,n,o)})))(Be.A),_e=(0,_.pM)({components:{WidgetZone:qe,WidgetHeader:De},props:Object.assign({},xe.i)});var $e=(0,Se.A)(_e,[["render",function(e,t,i,n,o,r){const a=(0,_.g2)("WidgetHeader"),s=(0,_.g2)("WidgetZone",!0);return(0,_.uX)(),(0,_.Wv)(s,{sectionIdentifier:e.sectionIdentifier,zoneIndex:e.zoneIndex,areaIdentifier:e.areaIdentifier},{widgetHeader:(0,_.k6)((({widgetTitle:e,widgetIdentifier:t})=>[(0,_.bF)(a,{widgetTitle:e,widgetIdentifier:t},null,8,["widgetTitle","widgetIdentifier"])])),_:1},8,["sectionIdentifier","zoneIndex","areaIdentifier"])}]]);var Ge=(0,_.pM)({mixins:[Oe.R],created(){this.widgetZone=(0,_.IG)($e)}});var Ue=(0,_.pM)({__name:"EditableArea",props:{identifier:{}},setup(e){return(e,t)=>((0,_.uX)(),(0,_.Wv)((0,_.R1)(Ce),{identifier:e.identifier},{sectionMarkup:(0,_.k6)((({sectionMarkup:t,sectionIdentifier:i})=>[(0,_.bF)(Ge,{sectionMarkup:t,sectionIdentifier:i,areaIdentifier:e.identifier},null,8,["sectionMarkup","sectionIdentifier","areaIdentifier"])])),sectionHeaderExtraButtons:(0,_.k6)((({sectionIdentifier:e})=>[(0,_.bF)((0,_.R1)(Me),{sectionIdentifier:e},null,8,["sectionIdentifier"])])),sectionDivider:(0,_.k6)((({sectionIdentifier:e,areaIdentifier:t})=>[(0,_.bF)((0,_.R1)(Y.A),{sectionIdentifier:e,areaIdentifier:t},null,8,["sectionIdentifier","areaIdentifier"])])),_:1},8,["identifier"]))}});const Xe={class:"ktc-form-builder-properties-panel"};var Qe=i(3829);const Ke=["id"],He={class:"ktc-form-builder-tab-content-inner"},Ze={id:"form-builder-validation",style:{display:"block"}},Ye={class:"ktc-label-property ktc-Top"},Je={class:"ktc-control-label"},et={class:"ktc-field-property"},tt={class:"ktc-field-rule-designer"},it=["id"];const nt={class:"ktc-rule-designer-rules"},ot={key:1,class:"ktc-alert ktc-alert-info"},rt=(0,_.Lk)("span",{class:"ktc-alert-icon"},[(0,_.Lk)("i",{class:"icon-i-circle"}),(0,_.Lk)("span",{class:"ktc-sr-only"},"Info")],-1),at={class:"ktc-alert-label"};var st=i(5812);const dt={class:"ktc-rule-row"},lt={class:"ktc-rule-actions"},ct=["title"],ut=(0,_.Lk)("i",{"aria-hidden":"true",class:"icon-bin"},null,-1),pt={class:"ktc-sr-only"};const ft={class:"ktc-rule-row ktc-edit-rule-row"},gt=["value"],mt={class:"ktc-rule-description"},vt=["id"];var ht=(0,_.pM)({data(){return{validationRulesWithMetadata:[],validationRuleInstanceIdentifier:"",renderRuleMarkupId:"",model:null}},created(){this.validationRuleInstanceIdentifier=this.editedValidationRuleConfiguration?this.editedValidationRuleConfiguration.validationRule.instanceIdentifier:this.newValidationRuleIdentifiers.filter((e=>e.widgetVariantIdentifier===this.widgetVariantIdentifier))[0].validationRuleIdentifier,this.renderRuleMarkupId=`jqueryLoaded-validationRuleConfigurationForm-${this.validationRuleInstanceIdentifier}`,this.validationRulesWithMetadata=this.validationRulesMetadata.map((e=>({metadata:e,validationRule:this.editedValidationRuleConfiguration&&w.yO.equalsIgnoreCase(this.editedValidationRuleConfiguration.identifier,e.identifier)?Object.assign({},this.editedValidationRuleConfiguration.validationRule):{instanceIdentifier:this.validationRuleInstanceIdentifier}}))),null!==this.editedValidationRuleConfiguration?this.model=this.validationRulesWithMetadata.filter((e=>w.yO.equalsIgnoreCase(e.metadata.identifier,this.editedValidationRuleConfiguration.identifier)))[0]:this.validationRulesMetadata.length>0&&(this.model=this.validationRulesWithMetadata[0])},props:{validationRulesMetadata:{default:[],type:Array},editedValidationRuleConfiguration:{default:null,type:Object},widgetVariantIdentifier:{required:!0,type:String},formFieldName:{required:!0,type:String},newValidationRuleIdentifiers:{type:Array},refreshPropertiesPanelsNotifier:{type:Boolean}},watch:{model:[{handler:"valueInSelectorChanged"}],refreshPropertiesPanelsNotifier:[{handler:"valueInSelectorChanged"}]},methods:{valueInSelectorChanged(){(async(e,t,i,n)=>{const o=W.q$.validationRuleMarkupEndpoint,r={formComponentInstanceIdentifier:e,formFieldName:n,validationRule:JSON.stringify(i),validationRuleIdentifier:t};return j((async()=>(await W.LV.post(o,r)).data))})(this.widgetVariantIdentifier,this.model.metadata.identifier,this.model.validationRule,this.formFieldName).then((e=>{F(this.renderRuleMarkupId,e)}))}}});var yt=(0,Se.A)(ht,[["render",function(e,t,i,n,o,r){return(0,_.uX)(),(0,_.CE)("div",ft,[(0,_.bo)((0,_.Lk)("select",{class:"ktc-form-control","onUpdate:modelValue":t[0]||(t[0]=t=>e.model=t)},[((0,_.uX)(!0),(0,_.CE)(_.FK,null,(0,_.pI)(e.validationRulesWithMetadata,(e=>((0,_.uX)(),(0,_.CE)("option",{key:e.metadata.identifier,value:e},(0,_.v_)(e.metadata.name),9,gt)))),128))],512),[[_.u1,e.model]]),(0,_.Lk)("span",mt,(0,_.v_)(e.model.metadata.description),1),(0,_.Lk)("div",{id:e.renderRuleMarkupId},null,8,vt)])}]]);var wt=(0,U.N)((e=>({refreshPropertiesPanelsNotifier:e.refreshPropertiesPanelsNotifier})))(yt),bt=(0,_.pM)({components:{ValidationRuleConfigurationForm:wt},data(){return{removeRuleLabel:(0,n.cQ)(a.SL.LocalizationService).getLocalization("propertiespanel.validationtab.removerule")}},methods:{expandContent(){this.$emit("expandRule",this.validationRuleConfiguration.validationRule.instanceIdentifier)},remove(){this.$emit("removeRule",this.validationRuleConfiguration.validationRule.instanceIdentifier)}},props:{formFieldName:{required:!0,type:String},isExpanded:{default:!1,type:Boolean},widgetVariantIdentifier:{required:!0,type:String},validationRuleConfiguration:{required:!0,type:Object},validationRulesMetadata:{default:[],type:Array}}});var It=(0,Se.A)(bt,[["render",function(e,t,i,n,o,r){const a=(0,_.g2)("ValidationRuleConfigurationForm");return(0,_.uX)(),(0,_.CE)("div",null,[(0,_.bo)((0,_.Lk)("div",dt,[(0,_.Lk)("span",{class:"ktc-rule-expandable-title",onClick:t[0]||(t[0]=(...t)=>e.expandContent&&e.expandContent(...t))},(0,_.v_)(e.validationRuleConfiguration.validationRule.title),1),(0,_.Lk)("div",lt,[(0,_.Lk)("button",{type:"button",onClick:t[1]||(t[1]=(...t)=>e.remove&&e.remove(...t)),class:"ktc-remove-rule ktc-icon-only ktc-btn-icon ktc-btn",title:e.removeRuleLabel},[ut,(0,_.Lk)("span",pt,(0,_.v_)(e.removeRuleLabel),1)],8,ct)])],512),[[_.aG,!e.isExpanded]]),e.isExpanded?((0,_.uX)(),(0,_.Wv)(a,{key:0,editedValidationRuleConfiguration:e.validationRuleConfiguration,validationRulesMetadata:e.validationRulesMetadata,widgetVariantIdentifier:e.widgetVariantIdentifier,formFieldName:e.formFieldName},null,8,["editedValidationRuleConfiguration","validationRulesMetadata","widgetVariantIdentifier","formFieldName"])):(0,_.Q3)("",!0)])}]]),Ct=(0,_.pM)({components:{ValidationRule:It,ValidationRuleConfigurationForm:wt},data(){return{localizationService:(0,n.cQ)(a.SL.LocalizationService)}},computed:{isNewRuleExpanded(){const e=this.getWidgetVariantToNewValidationRuleBinding();return e&&this.expandedValidationRuleIdentifier===e.validationRuleIdentifier}},created(){this.createNewValidationRuleIdentifier((0,Qe.A)(),this.widgetVariantIdentifier)},methods:{newRuleExpand(){this.expandValidationRule(this.getWidgetVariantToNewValidationRuleBinding().validationRuleIdentifier)},expandRule(e){this.expandValidationRule(e)},async removeRule(e){await(0,st.l)(this.localizationService.getLocalization("propertiespanel.validationtab.confirmationmessage.removevalidationrule"))&&this.$emit("removeValidationRule",e,this.widgetVariantIdentifier)},getWidgetVariantToNewValidationRuleBinding(){return this.newValidationRuleIdentifiers.filter((e=>e.widgetVariantIdentifier===this.widgetVariantIdentifier))[0]}},props:{validationRuleConfigurations:{default:[],type:Array},formFieldName:{required:!0,type:String},widgetVariantIdentifier:{required:!0,type:String},validationRulesMetadata:{default:[],type:Array},expandedValidationRuleIdentifier:{default:"",type:String},newValidationRuleIdentifiers:{type:Array},expandValidationRule:{type:Function},createNewValidationRuleIdentifier:{type:Function},freezeWidgetSelection:{type:Function}}});var Rt=(0,Se.A)(Ct,[["render",function(e,t,i,n,o,r){const a=(0,_.g2)("ValidationRule"),s=(0,_.g2)("ValidationRuleConfigurationForm");return(0,_.uX)(),(0,_.CE)("div",null,[(0,_.Lk)("div",nt,[((0,_.uX)(!0),(0,_.CE)(_.FK,null,(0,_.pI)(e.validationRuleConfigurations,(t=>((0,_.uX)(),(0,_.Wv)(a,{key:t.validationRule.instanceIdentifier,formFieldName:e.formFieldName,isExpanded:t.validationRule.instanceIdentifier===e.expandedValidationRuleIdentifier,validationRuleConfiguration:t,validationRulesMetadata:e.validationRulesMetadata,onExpandRule:e.expandRule,onRemoveRule:e.removeRule,widgetVariantIdentifier:e.widgetVariantIdentifier},null,8,["formFieldName","isExpanded","validationRuleConfiguration","validationRulesMetadata","onExpandRule","onRemoveRule","widgetVariantIdentifier"])))),128)),e.isNewRuleExpanded?((0,_.uX)(),(0,_.Wv)(s,{key:0,validationRulesMetadata:e.validationRulesMetadata,formFieldName:e.formFieldName,widgetVariantIdentifier:e.widgetVariantIdentifier,newValidationRuleIdentifiers:e.newValidationRuleIdentifiers},null,8,["validationRulesMetadata","formFieldName","widgetVariantIdentifier","newValidationRuleIdentifiers"])):(0,_.Q3)("",!0)]),e.validationRulesMetadata.length?((0,_.uX)(),(0,_.CE)("button",{key:0,onClick:t[0]||(t[0]=(...t)=>e.newRuleExpand&&e.newRuleExpand(...t)),class:"ktc-btn ktc-btn-default"},(0,_.v_)(e.localizationService.getLocalization("propertiespanel.validationtab.addvalidationrule")),1)):(0,_.Q3)("",!0),e.validationRulesMetadata.length?(0,_.Q3)("",!0):((0,_.uX)(),(0,_.CE)("div",ot,[rt,(0,_.Lk)("div",at,(0,_.v_)(e.localizationService.getLocalization("propertiespanel.validationtab.novalidationrules")),1)]))])}]]);var kt=(0,U.N)((e=>({expandedValidationRuleIdentifier:e.expandedValidationRuleIdentifier,newValidationRuleIdentifiers:e.newValidationRuleIdentifiers})),(()=>({expandValidationRule:te,createNewValidationRuleIdentifier:ie,freezeWidgetSelection:me.aK})))(Rt);const Et={class:"ktc-form-builder-visibility-section"},St=["id"];const Vt={class:"ktc-btn-group"},At=["onClick"],Pt={class:"ktc-tabs-details"};const Tt=(0,_.pM)({data(){return{tabs:[]}},methods:{selectTab(e){this.tabs.forEach((t=>{t.identifier===e.identifier?(this.onTabChange&&this.onTabChange(e),t.isActive=!0):t.isActive=!1}))}},props:{onTabChange:{type:Function}}});var Lt=(0,_.pM)({mixins:[Tt]});var Mt=(0,Se.A)(Lt,[["render",function(e,t,i,n,o,r){return(0,_.uX)(),(0,_.CE)("div",null,[(0,_.Lk)("div",Vt,[((0,_.uX)(!0),(0,_.CE)(_.FK,null,(0,_.pI)(e.tabs,(t=>((0,_.uX)(),(0,_.CE)("button",{key:t.identifier,type:"button",class:(0,_.C4)(["ktc-btn ktc-btn-default",{"ktc-active":t.isActive}]),onClick:i=>e.selectTab(t)},(0,_.v_)(t.getLocalizedString()),11,At)))),128))]),(0,_.Lk)("div",Pt,[(0,_.RG)(e.$slots,"default")])])}]]);var Ot=(0,_.pM)({data(){return{isActive:!1}},mounted(){this.isActive=this.selected},methods:{getLocalizedString(){return(0,n.cQ)(a.SL.LocalizationService).getLocalization(this.name)}},created(){this.$parent.tabs.push(this)},props:{identifier:{required:!0,type:String},name:{required:!0,type:String},selected:{default:!1,type:Boolean}}});var xt=(0,Se.A)(Ot,[["render",function(e,t,i,n,o,r){return(0,_.bo)(((0,_.uX)(),(0,_.CE)("div",null,[(0,_.RG)(e.$slots,"default")],512)),[[_.aG,e.isActive]])}]]),zt=(0,_.pM)({components:{Tab:xt,ButtonGroupSelector:Mt},data(){return{renderConditionMarkupId:"",tabAlwaysIdentifier:"always",neverVisibleVisibilityCondition:"Kentico.NeverVisible"}},created(){this.renderConditionMarkupId=`jqueryLoaded-visibilityCondition-${this.widgetVariantIdentifier}`},mounted(){this.refreshMarkup()},methods:{onTabChange(e){let t=null;if(e.identifier===this.tabAlwaysIdentifier)t={detail:{identifier:this.widgetVariantIdentifier,visibilityConditionConfiguration:null}};else{if(e.identifier!==this.neverVisibleVisibilityCondition)return void this.$nextTick(this.refreshMarkup);t={detail:{identifier:this.widgetVariantIdentifier,visibilityConditionConfiguration:{identifier:this.neverVisibleVisibilityCondition,visibilityCondition:{}}}}}document.dispatchEvent(new CustomEvent(P,t))},async refreshMarkup(){if(this.$refs.conditionTab.isActive){const e=await(async(e,t)=>{const i=W.q$.visibilityConditionMarkupEndpoint,n={formComponentInstanceIdentifier:e,formFieldName:t};return j((async()=>(await W.LV.post(i,n)).data))})(this.widgetVariantIdentifier,this.formFieldName);F(this.renderConditionMarkupId,e)}}},props:{widgetVariantIdentifier:{required:!0,type:String},visibilityConditionConfiguration:{type:Object||null},formFieldName:{required:!0,type:String},refreshPropertiesPanelsNotifier:{type:Boolean}},watch:{refreshPropertiesPanelsNotifier:[{handler:"refreshMarkup"}]}});var Wt=(0,Se.A)(zt,[["render",function(e,t,i,n,o,r){const a=(0,_.g2)("Tab"),s=(0,_.g2)("ButtonGroupSelector");return(0,_.uX)(),(0,_.CE)("div",Et,[(0,_.bF)(s,{onTabChange:e.onTabChange},{default:(0,_.k6)((()=>[(0,_.bF)(a,{identifier:e.tabAlwaysIdentifier,name:"propertiespanel.visibilityconditions.tab.always",selected:null==e.visibilityConditionConfiguration},null,8,["identifier","selected"]),(0,_.bF)(a,{identifier:e.neverVisibleVisibilityCondition,name:"propertiespanel.visibilityconditions.tab.never",selected:e.visibilityConditionConfiguration&&e.visibilityConditionConfiguration.identifier==e.neverVisibleVisibilityCondition},null,8,["identifier","selected"]),(0,_.bF)(a,{identifier:"condition",ref:"conditionTab",name:"propertiespanel.visibilityconditions.tab.condition",selected:e.visibilityConditionConfiguration&&e.visibilityConditionConfiguration.identifier!=e.neverVisibleVisibilityCondition},{default:(0,_.k6)((()=>[(0,_.Lk)("div",{id:e.renderConditionMarkupId},null,8,St)])),_:1},8,["selected"])])),_:1},8,["onTabChange"])])}]]);var Ft=(0,U.N)((e=>({refreshPropertiesPanelsNotifier:e.refreshPropertiesPanelsNotifier})))(Wt);const jt={class:"ktc-form-builder-tabs"},Dt={class:"ktc-form-builder-tabs-nav"},Nt=["onClick"],Bt={class:"ktc-form-builder-tab-content"},qt={class:"ktc-form-builder-tab-content-container"};var _t=(0,_.pM)({mixins:[Tt]});var $t=(0,Se.A)(_t,[["render",function(e,t,i,n,o,r){return(0,_.uX)(),(0,_.CE)("div",jt,[(0,_.Lk)("div",Dt,[((0,_.uX)(!0),(0,_.CE)(_.FK,null,(0,_.pI)(e.tabs,(t=>((0,_.uX)(),(0,_.CE)("a",{key:t.identifier,class:(0,_.C4)(["ktc-form-builder-tab-link",{"ktc-active":t.isActive}]),onClick:i=>e.selectTab(t)},(0,_.v_)(t.getLocalizedString()),11,Nt)))),128))]),(0,_.Lk)("div",Bt,[(0,_.Lk)("div",qt,[(0,_.RG)(e.$slots,"default")])])])}]]),Gt=(0,_.pM)({components:{ValidationRules:kt,Tab:xt,Tabs:$t,VisibilityConditionEditorForm:Ft},computed:{propertiesTabIdentifier(){return`jqueryLoaded-propertiesTab-${this.widgetProperties.guid}`},validationTabIdentifier(){return`jqueryLoaded-validationTab-${this.widgetProperties.guid}`}},mounted(){this.renderPropertiesEditor()},methods:{removeValidationRule(e,t){this.$emit("removeValidationRule",e,t)},renderPropertiesEditor(){(async e=>{const t=W.q$.propertiesEditorEndpoint;return j((async()=>(await W.LV.post(t,e)).data))})({identifier:this.widgetIdentifier,type:this.widgetType,properties:this.widgetProperties}).then((e=>{F(this.propertiesTabIdentifier,e),this.$emit("contentLoaded",{identifier:this.widgetIdentifier})}))}},props:{widgetIdentifier:{required:!0,type:String},widgetType:{required:!0,type:String},widgetProperties:{required:!0,type:Object},validationRulesMetadata:{default:()=>[],type:Array},refreshPropertiesPanelsNotifier:{type:Boolean}},watch:{refreshPropertiesPanelsNotifier:[{handler:"renderPropertiesEditor"}]}});var Ut=(0,Se.A)(Gt,[["render",function(e,t,i,n,o,r){const a=(0,_.g2)("Tab"),s=(0,_.g2)("ValidationRules"),d=(0,_.g2)("VisibilityConditionEditorForm"),l=(0,_.g2)("Tabs");return(0,_.uX)(),(0,_.Wv)(l,null,{default:(0,_.k6)((()=>[(0,_.bF)(a,{identifier:"propertiesTab",name:"propertiespanel.propertiestab.name",selected:!0},{default:(0,_.k6)((()=>[(0,_.Lk)("div",{id:e.propertiesTabIdentifier},null,8,Ke)])),_:1}),(0,_.bF)(a,{identifier:"validationTab",name:"propertiespanel.validationtab.name",selected:!1},{default:(0,_.k6)((()=>[(0,_.Lk)("div",He,[(0,_.Lk)("div",Ze,[(0,_.Lk)("div",Ye,[(0,_.Lk)("span",Je,(0,_.v_)(e.$_localizationService.getLocalization("propertiespanel.validationtab.rules")),1)]),(0,_.Lk)("div",et,[(0,_.Lk)("span",tt,[(0,_.bF)(s,{validationRuleConfigurations:e.widgetProperties.validationRuleConfigurations,validationRulesMetadata:e.validationRulesMetadata,formFieldName:e.widgetProperties.name,widgetVariantIdentifier:e.widgetProperties.guid,onRemoveValidationRule:e.removeValidationRule},null,8,["validationRuleConfigurations","validationRulesMetadata","formFieldName","widgetVariantIdentifier","onRemoveValidationRule"])])])]),(0,_.Lk)("div",{id:e.validationTabIdentifier},null,8,it)])])),_:1}),(0,_.bF)(a,{identifier:"visibilityTab",name:"propertiespanel.visibilitytab.name"},{default:(0,_.k6)((()=>[(0,_.bF)(d,{formFieldName:e.widgetProperties.name,widgetVariantIdentifier:e.widgetProperties.guid,visibilityConditionConfiguration:e.widgetProperties.visibilityConditionConfiguration,class:"ktc-form-builder-tab-content-inner"},null,8,["formFieldName","widgetVariantIdentifier","visibilityConditionConfiguration"])])),_:1})])),_:1})}]]);var Xt=(0,U.N)((e=>({refreshPropertiesPanelsNotifier:e.refreshPropertiesPanelsNotifier})))(Ut),Qt=(0,_.pM)({components:{PropertiesEditorForm:Xt},data(){return{requestedWidgetIdentifier:null,displayedWidgetIdentifier:null,markupsLoaded:[]}},computed:{wigdetsWithRequestedOrLoadedPropertiesMarkup(){return Object.values(this.widgets).filter((e=>e.identifier===this.requestedWidgetIdentifier||this.markupsLoaded[e.identifier]))}},mounted(){document.addEventListener(k,this.freezeWidgetSelectionEventCallback),document.addEventListener(S,this.propertiesStateChangedEventCallback),document.addEventListener(V,this.validationRuleStateChangedEventCallback),document.addEventListener(E,this.thawWidgetSelectionEventCallback),document.addEventListener(A,this.closeValidationRule),document.addEventListener(P,this.visibilityConditionChangedEventCallback)},beforeUnmount(){document.removeEventListener(k,this.freezeWidgetSelectionEventCallback),document.removeEventListener(S,this.propertiesStateChangedEventCallback),document.removeEventListener(V,this.validationRuleStateChangedEventCallback),document.removeEventListener(E,this.thawWidgetSelectionEventCallback),document.removeEventListener(A,this.closeValidationRule),document.removeEventListener(P,this.visibilityConditionChangedEventCallback)},methods:{onMouseDown(){this.disableWidgetClickAway()},freezeWidgetSelectionEventCallback(){this.freezeWidgetSelection()},async propertiesStateChangedEventCallback(e){const t=this.getWidgetVariant(e.detail.identifier),i=this.getWidget(t.identifier),n=Object.assign(Object.assign({},t.properties),e.detail.properties);await this.setWidgetProperties(i.identifier,n),this.thawWidgetSelection()},async visibilityConditionChangedEventCallback(e){const t=e.detail.identifier,i=e.detail.visibilityConditionConfiguration,n=this.getWidgetVariant(t),o=this.getWidget(n.identifier),r=Object.assign({},n.properties);r.visibilityConditionConfiguration=i;const a=Object.assign({},r);await this.setWidgetProperties(o.identifier,a),this.thawWidgetSelection()},async validationRuleStateChangedEventCallback(e){const t=e.detail.identifier,i=e.detail.validationRuleConfiguration,n=i.validationRule,o=this.getWidgetVariant(t),r=this.getWidget(o.identifier),a=Object.assign({},o.properties),s=a.validationRuleConfigurations;let d=s.filter((e=>e.validationRule.instanceIdentifier===n.instanceIdentifier))[0],l=null;d?(d=Object.assign(Object.assign({},d),i),l=[...s.map((e=>e.validationRule.instanceIdentifier!==d.validationRule.instanceIdentifier?e:d))],this.closeValidationRule()):(l=[...s,i],this.newValidationRuleAdded(i.validationRule.instanceIdentifier,(0,Qe.A)(),t)),a.validationRuleConfigurations=l;const c=Object.assign({},a);await this.setWidgetProperties(r.identifier,c),this.thawWidgetSelection()},async removeValidationRule(e,t){const i=this.getWidgetVariant(t),n=this.getWidget(i.identifier),o=Object.assign({},i.properties),r=o.validationRuleConfigurations.filter((t=>t.validationRule.instanceIdentifier!==e));o.validationRuleConfigurations=r;const a=Object.assign({},o);await this.setWidgetProperties(n.identifier,a)},closeValidationRule(){this.expandValidationRule(null)},getWidgetVariant(e){return Object.values(this.widgetVariants).filter((t=>t.properties.guid===e))[0]},getWidget(e){return Object.values(this.widgets).filter((t=>t.variants[0]===e))[0]},thawWidgetSelectionEventCallback(){this.thawWidgetSelection()},getWidgetProperties(e){return this.widgetVariants[e.variants[0]].properties},getCompatibleValidationRulesMetadata(e){const t=this.widgetMetadata[e.type];return this.validationRulesMetadataPerType[t.valueType]},propertiesEditorFormContentLoaded(e){this.markupsLoaded[e.identifier]=!0,this.requestedWidgetIdentifier===e.identifier&&(this.displayedWidgetIdentifier=e.identifier)},loadPropertiesEditor(){if(this.savingInProgress)return;const e=this.widgets[this.widgetSelection.identifier];e&&"Kentico.Invalid"!==e.type?(this.requestedWidgetIdentifier=this.widgetSelection.identifier,this.markupsLoaded[this.requestedWidgetIdentifier]&&(this.displayedWidgetIdentifier=this.requestedWidgetIdentifier),this.widgetSelection.identifier||(this.displayedWidgetIdentifier=null)):this.displayedWidgetIdentifier=null}},props:{widgetVariants:{type:Object},widgets:{type:Object},widgetSelection:{type:Object},validationRulesMetadataPerType:{type:Object},widgetMetadata:{type:Object},savingInProgress:{type:Boolean},freezeWidgetSelection:{type:Function},setWidgetProperties:{type:Function},thawWidgetSelection:{type:Function},newValidationRuleAdded:{type:Function},expandValidationRule:{type:Function},disableWidgetClickAway:{type:Function}},watch:{"widgetSelection.identifier":[{handler:"loadPropertiesEditor"}],savingInProgress:[{handler:"loadPropertiesEditor"}]}});const Kt=(0,Se.A)(Qt,[["render",function(e,t,i,n,o,r){const a=(0,_.g2)("PropertiesEditorForm");return(0,_.uX)(),(0,_.CE)("div",Xe,[((0,_.uX)(!0),(0,_.CE)(_.FK,null,(0,_.pI)(e.wigdetsWithRequestedOrLoadedPropertiesMarkup,(t=>(0,_.bo)(((0,_.uX)(),(0,_.Wv)(a,{key:t.identifier,widgetIdentifier:t.identifier,widgetType:t.type,widgetProperties:e.getWidgetProperties(t),validationRulesMetadata:e.getCompatibleValidationRulesMetadata(t),onMousedown:e.onMouseDown,onContentLoaded:e.propertiesEditorFormContentLoaded,onRemoveValidationRule:e.removeValidationRule},null,8,["widgetIdentifier","widgetType","widgetProperties","validationRulesMetadata","onMousedown","onContentLoaded","onRemoveValidationRule"])),[[_.aG,t.identifier===e.displayedWidgetIdentifier&&e.markupsLoaded[t.identifier]]]))),128)),e.displayedWidgetIdentifier?(0,_.Q3)("",!0):(0,_.RG)(e.$slots,"default",{key:0})])}]]);var Ht=Kt;var Zt=(0,U.N)((e=>({validationRulesMetadataPerType:e.validationRulesMetadata,widgetMetadata:e.metadata.widgets,widgetVariants:e.widgetVariants,widgets:e.widgets,widgetSelection:e.widgetSelection,savingInProgress:e.savingInProgress})),(()=>({expandValidationRule:te,freezeWidgetSelection:me.aK,newValidationRuleAdded:ne,setWidgetProperties:be,thawWidgetSelection:me.Ro,disableWidgetClickAway:me.je})))(Ht);var Yt=(0,_.pM)({data(){return{timeoutID:null,showMessage:!1}},props:{savingInProgress:{type:Boolean},fadeOutDuration:{default:2e3,type:Number}},watch:{savingInProgress:[{handler:"onSave"}]},methods:{onSave(e){this.showMessage=!0,e?e&&this.timeoutID&&(window.clearTimeout(this.timeoutID),this.timeoutID=null):this.timeoutID=window.setTimeout((()=>{this.showMessage=!1}),this.fadeOutDuration)}}});var Jt=(0,Se.A)(Yt,[["render",function(e,t,i,n,o,r){return(0,_.bo)(((0,_.uX)(),(0,_.CE)("div",null,[e.savingInProgress?(0,_.RG)(e.$slots,"saving",{key:0}):(0,_.Q3)("",!0),e.savingInProgress?(0,_.Q3)("",!0):(0,_.RG)(e.$slots,"saved",{key:1})],512)),[[_.aG,e.showMessage]])}]]);var ei=(0,U.N)((e=>({savingInProgress:e.savingInProgress})))(Jt),ti=i(1040);class ii extends ti.E{constructor(e,t,i,n,o,r,a,s,d,l,c,u){super(a,s,d,l,c,u,null),this.formIdentifier=e,this.propertiesEditorEndpoint=t,this.validationRuleMetadataEndpoint=i,this.validationRuleMarkupEndpoint=n,this.visibilityConditionMarkupEndpoint=o,this.saveMessageClientId=r}validate(){if(0===this.formIdentifier)throw new Error((0,n.cQ)(a.SL.LocalizationService).getLocalization("notinitialized"))}getComponentMarkupData(e){return{postedData:e,formIdentifier:this.formIdentifier}}}var ni=i(1829),oi=i(1265),ri=i(9060),ai=i(5612),si=i(2079),di=i(8776),li=i(8021);const ci=(0,ni.HY)(Object.assign(Object.assign({},li.X),{config:(e=null)=>e,expandedValidationRuleIdentifier:(e=null,t)=>{switch(t.type){case(0,ee.getType)(te):return t.payload.validationRuleIdentifier;case(0,ee.getType)(ne):return null;default:return e}},newValidationRuleIdentifiers:(e=[],t)=>{switch(t.type){case(0,ee.getType)(ie):return[...e.filter((e=>e.widgetVariantIdentifier!==t.payload.widgetVariantIdentifier)),{validationRuleIdentifier:t.payload.identifierForNewValidationRule,widgetVariantIdentifier:t.payload.widgetVariantIdentifier}];case(0,ee.getType)(ne):return[...e.filter((e=>e.validationRuleIdentifier!==t.payload.validationRuleIdentifier)),{validationRuleIdentifier:t.payload.identifierForNewValidationRule,widgetVariantIdentifier:t.payload.widgetVariantIdentifier}];default:return e}},refreshPropertiesPanelsNotifier:(e=null,t)=>t.type===(0,ee.getType)(oe)?!e:e,savingInProgress:(e=null,t)=>{switch(t.type){case(0,ee.getType)(re):return!0;case(0,ee.getType)(ae):return!1;default:return e}},validationRulesMetadata:(e={})=>e})),ui=(e,t)=>{const i=(0,ai.Y)(t);return(0,ni.y$)(ci,e,i((0,ni.Tw)(oi.A.withExtraArgument((0,ri.n)()),di.G,si.i)))};var pi=i(8037),fi=i(88);var gi=(0,U.N)((({modalDialogs:e,popup:t})=>({modalDialogs:e.dialogs.filter((e=>e.type===K.WV.Custom)),popupType:t.popupType})),(()=>({selectItem:new fi.Y(he,ue).selectItem})))(pi.A),mi=i(680),vi=i(8999);const hi=["id",".configuration",".messages",".isModified"],yi=[".localizationService",".formMarkup",".componentName",".isValid",".theme",".openedDialogsCount"];var wi=i(1575);var bi=(0,_.pM)({data(){return{$refs:undefined,dialogIndex:0,formChanged:!1}},computed:{dialogConfiguration(){return{title:this.componentName,showFooter:!0,applyButtonText:this.$_localizationService.getLocalization("widgetproperties.apply"),cancelButtonText:this.$_localizationService.getLocalization("widgetproperties.cancel"),tabs:null,theme:this.dialogTheme,showLoader:!1,dialogIndex:this.dialogIndex,openedDialogsCount:this.dialogsCount,width:"600px",maximized:!1,setPosition:!1}},modalDialogStyles(){return this.dialogsCount>1?{}:{top:0,left:0,bottom:0,right:0,position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10200}},dialogMessages(){return{unsavedChanges:this.$_localizationService.getLocalization("modalDialog.close.confirmation"),loaderMessage:this.$_localizationService.getLocalization("modaldialogs.loading"),closeTooltip:this.$_localizationService.getLocalization("typelist.closeTooltip")}}},async mounted(){(0,wi.L)(document),await this.fetchMarkup(this.dialogIndex,this.propertiesFormUrl,this.properties)},beforeUnmount(){0===this.dialogIndex&&(0,wi.Q)(document)},methods:{async onSubmitPropertiesForm(e){await this.submitDialogForm(this.dialogIndex,e.detail.configurationForm.getAttribute("action"),this.properties,e.detail.formData)},onFormChange(){this.formChanged=!0},onDialogClose(){this.closeDialog(this.dialogIndex)},async onDialogApply(){await this.$refs.propertiesForm.validateProperties()}},props:{formMarkup:{type:String},properties:{type:Object},propertiesFormUrl:{type:String},componentName:{type:String},formIsValid:{type:Boolean},dialogId:{type:String},dialogTheme:{type:String},dialogsCount:{type:Number},closeDialog:{type:Function},fetchMarkup:{type:Function},submitDialogForm:{type:Function}}});var Ii=(0,Se.A)(bi,[["render",function(e,t,i,n,o,r){return(0,_.uX)(),(0,_.CE)("kentico-modal-dialog",{id:e.dialogId,".configuration":e.dialogConfiguration,".messages":e.dialogMessages,".isModified":e.formChanged,style:(0,_.Tr)(e.modalDialogStyles),onApply:t[2]||(t[2]=(...t)=>e.onDialogApply&&e.onDialogApply(...t)),onClose:t[3]||(t[3]=(...t)=>e.onDialogClose&&e.onDialogClose(...t))},[(0,_.Lk)("kentico-properties-form",{ref:"propertiesForm",".localizationService":e.$_localizationService,".formMarkup":e.formMarkup,".componentName":e.componentName,".isValid":e.formIsValid,".theme":e.dialogTheme,".openedDialogsCount":e.dialogsCount,"on:submitPropertiesForm":t[0]||(t[0]=(...t)=>e.onSubmitPropertiesForm&&e.onSubmitPropertiesForm(...t)),"on:formChange":t[1]||(t[1]=(...t)=>e.onFormChange&&e.onFormChange(...t))},null,40,yi)],44,hi)}]]),Ci=i(6996),Ri=i(8885),ki=i(7307);class Ei{constructor(e){this.setSectionPropertiesThunk=e,this.submitPropertiesDialogForm=(e,t,i,n)=>async(o,r,a)=>{try{const a=await(0,ki.j)(t,n);if(this.isFormValid(a)){const{modalDialogs:t}=r(),n=t.dialogs[e],s=Object.assign({},i,a.data.properties);if(!(0,Ci.A)(i,s)){const e=this.setSectionPropertiesThunk;await o(e(n.identifier,s));const t=W.q$;await ce(o,r(),t.formIdentifier.toString())}o((0,mi.CO)(e))}else o((0,Ri.pK)(e)),o((0,Ri.dO)(e,a.data))}catch(e){a.logger.logException(e)}},this.isFormValid=e=>"valid"===e.status}}var Si=(0,U.N)((e=>{const{modalDialogs:t}=e,i=t.dialogs[0];if(!i)return null;const{type:n,markup:o,isValid:r,title:a,markupUrl:s,model:d}=i;return{componentName:a,dialogId:vi.gE,dialogType:n,dialogTheme:t.theme,formMarkup:o,properties:d,propertiesFormUrl:s,formIsValid:r,dialogsCount:t.dialogs.length}}),(()=>({closeDialog:mi.CO,fetchMarkup:mi.wB,submitDialogForm:new Ei(mi.tH).submitPropertiesDialogForm})))(Ii);var Vi=(0,_.pM)({__name:"FormBuilderGlobalComponentWrapper",props:{showPropertiesDialog:{type:Boolean}},setup(e){return(e,t)=>((0,_.uX)(),(0,_.Wv)((0,_.R1)(gi),null,{default:(0,_.k6)((()=>[e.showPropertiesDialog?((0,_.uX)(),(0,_.Wv)((0,_.R1)(Si),{key:0})):(0,_.Q3)("",!0)])),_:1}))}});var Ai=(0,U.N)((({modalDialogs:e})=>({showPropertiesDialog:!!e.dialogs.length&&e.dialogs[0].type!==K.WV.Custom})))(Vi),Pi=i(1111),Ti=i(1338),Li=i(9800),Mi=i(596);const Oi=e=>{e&&e.toolbarButtons&&xi(e)},xi=e=>{const t=[Ti.l4],i=[Li.I7,Li._j],n=[Li.wd,Li.KB,Mi.Dw,Li.Xh];if(Array.isArray(e.imageEditButtons)&&(e.imageEditButtons=e.imageEditButtons.filter((e=>!t.includes(e)))),Array.isArray(e.quickInsertButtons)&&(e.quickInsertButtons=e.quickInsertButtons.filter((e=>!i.includes(e)))),Array.isArray(e.toolbarButtons))e.toolbarButtons=e.toolbarButtons.filter((e=>!n.includes(e)));else if((0,Pi.e)(e.toolbarButtons))for(const t of Object.values(e.toolbarButtons))t&&t.buttons&&(t.buttons=t.buttons.filter((e=>!n.includes(e))))};var zi,Wi,Fi,ji=function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,i,a):o(t,i))||a);return r>3&&a&&Object.defineProperty(t,i,a),a},Di=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Ni=function(e,t){return function(i,n){t(i,n,e)}};let Bi=class extends $.M{constructor(e,t,i){super(e,t,i)}async initializeFormBuilder(e){const t=new ii(e.formIdentifier,e.propertiesEditorEndpoint,e.validationRuleMetadataEndpoint,e.validationRuleMarkupEndpoint,e.visibilityConditionMarkupEndpoint,e.saveMessageClientId,e.applicationPath,e.configurationEndpoints,e.metadataEndpoint,e.allowedOrigins,e.propertiesEditorClientId,e.constants),i=await super.initialize(t,(t=>ui(t,e.developmentMode)),Ai,Ue,ye,ge),n=(0,U.C)(i);this.initializePropertiesEditor(n,t),this.initializeSaveMessage(n,t),this.registerFormScrollListener(i),document.addEventListener(Z.JB,(({target:t,detail:i})=>{(0,H.F)(t,i,Oi,e.htmlSanitizer,!1)}))}initializePropertiesEditor(e,t){const i=(0,_.Ef)({components:{PropertiesEditor:Zt},el:`#${t.propertiesEditorClientId}`,mixins:[e]});i.config.globalProperties.$_localizationService=this.localizationService,i.mount(`#${t.propertiesEditorClientId}`)}initializeSaveMessage(e,t){const i=(0,_.Ef)({components:{SaveMessage:ei},el:`#${t.saveMessageClientId}`,mixins:[e]});i.config.globalProperties.$_localizationService=this.localizationService,i.mount(`#${t.saveMessageClientId}`)}registerFormScrollListener(e){const t=document.body.querySelector(".ktc-form-builder-mvc-form");t.addEventListener("scroll",(()=>{const{popup:i}=e.getState(),n=(null==i?void 0:i.popupType)===K.GI.AddWidget?t.querySelector("kentico-add-component-button[is-active]"):(null==i?void 0:i.popupType)===K.GI.AddSection?t.querySelector("kentico-section-divider[active]").shadowRoot.querySelector("kentico-add-component-button[is-active]"):null;if(n){const t=(0,X.m9)(n.getBoundingClientRect()),o=(0,X.ME)(n.getBoundingClientRect());e.dispatch((0,Q.iy)(i.horizontalPosition,o,t))}}))}};Bi=ji([(0,s._)(),Ni(0,(0,q.W)(a.SL.LocalizationService)),Ni(1,(0,q.W)(a.SL.PageConfigurationService)),Ni(2,(0,q.W)(a.SL.MessagingService)),Di("design:paramtypes",["function"==typeof(zi=void 0!==G.LocalizationService&&G.LocalizationService)?zi:Object,"function"==typeof(Wi=void 0!==x.L&&x.L)?Wi:Object,"function"==typeof(Fi=void 0!==r.U&&r.U)?Fi:Object])],Bi),(0,n.qx)(B),window.kentico=window.kentico||{},window.kentico.formBuilder={init:async e=>{const t=(0,n.Wl)(Bi);await t.initializeFormBuilder(e)}}}},i={};function n(e){var o=i[e];if(void 0!==o)return o.exports;var r=i[e]={id:e,loaded:!1,exports:{}};return t[e].call(r.exports,r,r.exports,n),r.loaded=!0,r.exports}n.m=t,e=[],n.O=function(t,i,o,r){if(!i){var a=1/0;for(c=0;c<e.length;c++){i=e[c][0],o=e[c][1],r=e[c][2];for(var s=!0,d=0;d<i.length;d++)(!1&r||a>=r)&&Object.keys(n.O).every((function(e){return n.O[e](i[d])}))?i.splice(d--,1):(s=!1,r<a&&(a=r));if(s){e.splice(c--,1);var l=o();void 0!==l&&(t=l)}}return t}r=r||0;for(var c=e.length;c>0&&e[c-1][2]>r;c--)e[c]=e[c-1];e[c]=[i,o,r]},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},function(){var e={531:0};n.O.j=function(t){return 0===e[t]};var t=function(t,i){var o,r,a=i[0],s=i[1],d=i[2],l=0;if(a.some((function(t){return 0!==e[t]}))){for(o in s)n.o(s,o)&&(n.m[o]=s[o]);if(d)var c=d(n)}for(t&&t(i);l<a.length;l++)r=a[l],n.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return n.O(c)},i=self.webpackChunkpage_builder=self.webpackChunkpage_builder||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))}();var o=n.O(void 0,[96,624],(function(){return n(4773)}));o=n.O(o)}();